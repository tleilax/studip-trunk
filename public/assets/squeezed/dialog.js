(function(d,c){if(jQuery.ui===undefined){throw"Overlays require jQuery UI"}var b=null,a={};a.show=function(e,f){if(b===null){f=f||"body";b=d('<div class="ui-front modal-overlay">');if(e){b.addClass("modal-overlay-ajax");if(e==="dark"){b.addClass("modal-overlay-dark")}}if(f!=="body"){b.addClass("modal-overlay-local")}b.appendTo(f)}};a.hide=function(){if(b!==null){b.remove();b=null}};c.Overlay=a}(jQuery,STUDIP));(function(c,h){function d(j){if(j.toLowerCase()==="true"){return true}if(j.toLowerCase()==="false"){return false}if(/^[+\-]\d+$/.test(j)){return parseInt(j,10)}if(/^[+\-]\d+\.\d+$/.test(j)){return parseFloat(j,10)}return j.replace(/^(["'])(.*)\1$/,"$2")}function g(l,m){var j=m?(l.match(/\w+\[(.*?)\]/g)||[]):[l],k={};j.forEach(function(v){if(m&&(v.indexOf(m)!==0||v===m)){return}var u=m?v.replace(/^\w+\[(.*)\]$/,"$1"):v,t="",w="",q=false,n=0,s=false,p=u.length,o,y,x,r;for(r=0;r<p;r+=1){o=u[r];y=false;x=false;if(q&&o==="\\"&&n<=0){n=2}else{if(!q&&o==="="){q=true;x=true}else{if(q&&w.length===0&&(o==='"'||o==="'")){s=o}else{if(q&&s&&n<=0&&o===s){s=false}else{if(!s&&o===";"){y=true;x=true}}}}}if(!x&&n<=0){if(q){w+=o}else{t+=o}}n-=1;if(y||r===u.length-1){if(r===u.length-1&&s){throw"Invalid data, missing closing quote"}if(t.length>0){k[t]=q?d(w):true}q=false;s=false;t="";w=""}}});return k}function i(j){var k={};c('[rel~="lightbox-button"],[rel~="option"],[data-dialog-button]',j).hide().find("a,button").andSelf().filter("a,button").each(function(){var l=c(this).text(),n=c(this).is(".cancel"),m;m=function(o){this.click()};m=m.bind(this);if(c(this).is(".accept,.cancel")){k[n?"cancel":l]={text:l,click:m,"class":n?"cancel":"accept"}}else{k[l]=m}});return k}h.Dialog={instances:{},stack:[],hasInstance:function(j){j=j||"default";return this.instances.hasOwnProperty(j)},getInstance:function(j){if(this.stack.length===0){this.disableScrolling()}j=j||"default";if(!this.hasInstance(j)){this.instances[j]={open:false,element:c("<div>"),options:{},previous:this.stack[0]||false};this.stack.unshift(j)}return this.instances[j]},removeInstance:function(k){k=k||"default";if(this.hasInstance(k)){delete this.instances[k];var j=this.stack.indexOf(k);this.stack.splice(j,1)}if(this.stack.length===0){this.enableScrolling()}},shouldOpen:function(){return c(window).innerWidth()>=800&&c(window).innerHeight()>=400},handlers:{header:{}},disableScrolling:function(){c("html").css("overflow","hidden")},enableScrolling:function(){c("html").css("overflow","")}};h.Dialog.handlers.header["X-Location"]=function(j,k){if(document.location.href===j){document.location.reload(true)}else{c(window).on("hashchange",function(){document.location.reload(true)}).on("unload",function(){c(window).off("hashchange")})}h.Dialog.close(k);document.location=j;return false};h.Dialog.handlers.header["X-Dialog-Execute"]=function(k,j,n){var p=k.trim().split("."),o=window,m=n.getResponseHeader("Content-Type").match(/json/)?c.parseJSON(n.responseText):n.responseText;try{k=c.parseJSON(k)}catch(l){k={func:k}}if(!k.hasOwnProperty("func")){throw"Dialog: Invalid value for X-Dialog-Execute"}if(!k.hasOwnProperty("payload")){k.payload=n.getResponseHeader("Content-Type").match(/json/)?c.parseJSON(n.responseText):n.responseText}p=k.func.trim().split(".");c.each(p,function(r,q){if(!o.hasOwnProperty(q)){throw"Dialog: Undefined callback "+k}o=o[q]});if(typeof o!=="function"){throw"Dialog: Given callback is not a valid function"}return o(k.payload,n)};h.Dialog.handlers.header["X-Dialog-Close"]=function(k,j){h.Dialog.close(j);return false};h.Dialog.handlers.header["X-Wikilink"]=function(k,j){j.wiki_link=k};h.Dialog.handlers.header["X-Title"]=function(k,j){j.title=k||j.title};h.Dialog.handlers.header["X-No-Buttons"]=function(k,j){j.buttons=false};h.Dialog.fromElement=function(l,k){k=k||{};if(c(l).is(":disabled")||!h.Dialog.shouldOpen()){return}if(k.close){h.Dialog.close(k);return}if(!c(l).is("a,button,form,input[type=image],input[type=submit]")){throw"Dialog.fromElement called on an unsupported element."}k.origin=l;k.title=k.title||h.Dialog.getInstance(k.id).options.title||c(l).attr("title")||c(l).filter("a,button").text();k.method="get";k.data={};var j;if(c(l).is("form,button,input")){j=c(l).attr("formaction")||c(l).closest("form").data("formaction")||c(l).closest("form").attr("action");k.method=c(l).closest("form").attr("method");k.data=c(l).closest("form").serializeArray();if(c(l).is("button,input")){k.data.push({name:c(l).attr("name"),value:c(l).val()})}else{if(c(l).data().triggeredBy){k.data.push(c(l).data().triggeredBy)}}c(l).closest("form").removeData("formaction")}else{j=c(l).attr("href")}return h.Dialog.fromURL(j,k)};h.Dialog.fromURL=function(k,j){j=j||{};if(!h.Dialog.shouldOpen()){location.href=k}if(h.Overlay){if(h.Dialog.getInstance(j.id).open){h.Overlay.show(true,h.Dialog.getInstance(j.id).element.parent())}else{h.Overlay.show(true)}}c.ajax({url:k,type:(j.method||"get").toUpperCase(),data:j.data||{},headers:{"X-Dialog":true}}).done(function(m,l,o){var n=true;c(j.origin||document).trigger("dialog-load",{xhr:o,options:j});c.each(h.Dialog.handlers.header,function(s,q){var r=o.getResponseHeader(s),p=true;if(r!==null){p=q(r,j,o)}n=n&&p!==false;return p});if(n){h.Dialog.show(m,j)}}).always(function(){if(h.Overlay){h.Overlay.hide()}});return true};var e=0;c(document).ready(function(){var j=c('<div class="ui-dialog" style="position: absolute;left:-1000px;top:-1000px;"></div>');j.html('<div class="ui-dialog-content ui-widget-content"><div style="width: 100%">foo</div></div>');j.appendTo("body");e=j.outerWidth(true)-c(".ui-dialog-content",j).width();j.remove()});h.Dialog.show=function(o,s){s=c.extend({},h.Dialog.options,s);var m=c("<div>"+o+"</div>").filter("script"),l={},p=h.Dialog.getInstance(s.id),n=p.previous!==false?h.Dialog.getInstance(p.previous):false,j=s.width||c("body").width()*2/3,r=s.height||c("body").height()*2/3,q,k;if(p.open){s.title=s.title||p.element.dialog("option","title")}if(s["center-content"]){o='<div class="studip-dialog-centered-helper">'+o+"</div>";l.dialogClass="studip-dialog-centered"}p.element.hide().html(o);if(s.size&&(s.size==="auto"||s.size==="fit")){k=c('<div class="ui-dialog">').addClass(s.dialogClass||l.dialogClass||"");c('<div class="ui-dialog-content">').html(o).appendTo(k);k.css({position:"absolute",left:"-10000px",top:"-10000px",width:"auto"}).appendTo("body");c("[data-dialog-button]",k).css("white-space","nowrap");j=Math.min(k.outerWidth(true)+e,j);r=Math.min(k.outerHeight(true)+113,r);if(s.size==="auto"){j=Math.max(300,j);r=Math.max(200,r)}}else{if(s.size&&s.size==="big"){j=c("body").width()*0.9;r=c("body").height()*0.8}else{if(s.size&&s.size==="small"){j=300;r=200}else{if(s.size&&s.size.match(/^\d+x\d+$/)){q=s.size.split("x");j=q[0];r=q[1]}else{if(s.size&&!s.size.match(/\D/)){j=r=s.size}}}}}j=Math.min(j,c("body").width()*0.95);r=Math.min(r,c("body").height()*0.9);if(n!==false&&j>n.dimensions.width&&r>n.dimensions.height){j=j>n.dimensions.width?n.dimensions.width*0.95:j;r=r>n.dimensions.height?n.dimensions.height*0.95:r}p.options=s;p.dimensions={width:window.parseInt(j,10),height:window.parseInt(r,10)};l=c.extend(l,{width:j,height:r,dialogClass:s.dialogClass||l.dialogClass||"",buttons:s.buttons||{},title:c("<div>").text(s.title||"").html(),modal:true,resizable:s.hasOwnProperty("resize")?s.resize:true,create:function(t){c(t.target).parent().css("position","fixed")},resizeStop:function(u,v){var t=[Math.floor(v.position.left)-c(window).scrollLeft(),Math.floor(v.position.top)-c(window).scrollTop()];c(u.target).parent().css("position","fixed");c(u.target).dialog("option","position",t)},open:function(){var u=c('.helpbar a[href*="docs.studip.de"]'),w=u.text(),v=s.wiki_link||u.attr("href"),t=c('<a class="ui-dialog-titlebar-wiki" target="_blank">').attr("href",v).attr("title",w);if(s.wikilink===undefined||s.wikilink!==false){c(this).siblings(".ui-dialog-titlebar").find(".ui-dialog-titlebar-close").before(t)}p.open=true;c("head").append(m);c(s.origin||document).trigger("dialog-open",{dialog:this,options:s})},close:function(t){c(s.origin||document).trigger("dialog-close",{dialog:this,options:s});h.Dialog.close(s)}});if(!s.hasOwnProperty("buttons")||(s.buttons&&!c.isPlainObject(s.buttons))){l.buttons=i.call(this,p.element);if(!l.buttons.hasOwnProperty("cancel")){l.buttons.cancel={text:"Abbrechen".toLocaleString()}}l.buttons.cancel.click=function(){h.Dialog.close(s)}}c("#layout_wrapper").css({WebkitFilter:"blur("+h.Dialog.stack.length+"px)",filter:"blur("+h.Dialog.stack.length+"px)"});p.element.dialog(l);c(document).trigger("dialog-update",{dialog:p.element,options:s})};h.Dialog.close=function(k){k=k||{};if(h.Dialog.hasInstance(k.id)){var j=h.Dialog.getInstance(k.id);if(j.open){j.open=false;try{j.element.dialog("close");j.open=j.element.dialog("isOpen")}catch(m){}if(j.open){return false}try{j.element.dialog("destroy");j.element.remove()}catch(l){}}h.Dialog.removeInstance(k.id);c("#layout_wrapper").css({WebkitFilter:"blur("+h.Dialog.stack.length+"px)",filter:"blur("+h.Dialog.stack.length+"px)"})}if(k["reload-on-close"]){window.location.reload()}};h.Dialog.confirm=function(j,l,k){h.Dialog.show(j,{id:"confirmation-dialog",title:"Bitte best√§tigen Sie die Aktion".toLocaleString(),size:"fit",wikilink:false,dialogClass:"studip-confirmation",buttons:{accept:{text:"Ja".toLocaleString(),click:function(){h.Dialog.close({id:"confirmation-dialog"});if(c.isFunction(l)){l()}},"class":"accept"},cancel:{text:"Nein".toLocaleString(),click:function(){h.Dialog.close({id:"confirmation-dialog"});if(c.isFunction(k)){k()}},"class":"cancel"}}})};function b(k){if(!k.isDefaultPrevented()){var l=c(k.target).closest("[data-dialog]"),j=l.data().dialog;if(h.Dialog.fromElement(l,g(j))){k.preventDefault()}}}function f(k){if(!k.isDefaultPrevented()){var j=c(k.target).closest("form"),l=c(k.target).attr("formaction");j.data("triggeredBy",{name:c(k.target).attr("name"),value:c(k.target).val()});if(l){j.data("formaction",l)}}}c(document).on("click","a[data-dialog],button[data-dialog],input[type=image][data-dialog],input[type=submit][data-dialog]",b).on("click","form[data-dialog] :submit",f).on("click","form[data-dialog] input[type=image]",f).on("submit","form[data-dialog]",b);c(document).on("click",".ui-widget-overlay",function(){if(c(".ui-dialog").length>0&&h.Dialog.stack.length){h.Dialog.close({id:h.Dialog.stack[0]})}});h.parseOptions=g;function a(k){var j=c(k.target).attr("rel");if(/\blightbox(\s|\[|$)/.test(j)){if(h.Dialog.fromElement(k.target,g(j,"lightbox"))){k.preventDefault()}}}c(document).on("click","a[rel*=lightbox],button[rel*=lightbox]",a).on("submit","form[rel*=lightbox]",a)}(jQuery,STUDIP));