<?
// first of all init I18N because seminar_open is not called here...
require_once("$ABSOLUTE_PATH_STUDIP/language.inc.php");
global $_language, $_language_path;
if (!isset($_language))
	$_language = get_accepted_languages();
$_language_path = init_i18n($_language);
?>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
	<meta name="copyright" content="Stud.IP-Crew (crew@studip.de)">
  <title>Stud.IP</title>
	<link rel="stylesheet" href="style.css" type="text/css">
<script type="text/javascript" language="javascript" src="md5.js"></script>
<script type="text/javascript" language="javascript">
<!--
  function doChallengeResponse() {
    str = document.login.username.value + ":" +
	  MD5(document.login.password.value) + ":" +
	  document.login.challenge.value;

    document.login.response.value = MD5(str);
    document.login.password.value = "";
    document.login.resolution.value = screen.width+"x"+screen.height;
    document.login.submit();
	return false;
  }
  
<? if (CLOSE_ON_LOGIN_SCREEN === true) echo "self.close();";?>
// -->
</script>
</head>

<body bgcolor="#ffffff">
<table width="75%" align="center" border=0 cellpadding=0 cellspacing=0>
<tr><td class="topic"><img src="pictures/login.gif" border="0"><b>&nbsp;<?=_("Stud.IP - Login")?></b></td></tr>
<tr><td class="blank">

	<? 
	global $HTTP_COOKIE_VARS, $username;
	
	require_once("msg.inc.php");
		
	if ($username && !$HTTP_COOKIE_VARS[$sess->name])
	{
		?>
		<table width="96%" class=blank border=0 cellpadding=0 cellspacing=0>
		<tr>
			<td class="blank">
			&nbsp;  
			</td>
		</tr>
		<? parse_msg ("error§<b>" . _("Cookies sind nicht aktiviert!") . "</b>§info§" . sprintf(_("Die Anmeldung für Stud.IP ist nur möglich, wenn Sie das Setzen von Cookies erlauben! Bitte &auml;ndern Sie Ihre Einstellungen und und wiederholen Sie den %sLogin"), "<a href=\"".$this->url()."\">") . "</a>", "§", "blank", 1, TRUE);?>
		<tr>
			<td class="blank">
			
			<b>&nbsp; <?=_("Was sind Cookies?")?></b><br /><br />
			<blockquote>
			<font size =-1><?=_("Cookies werden normalerweise benutzt, damit der Browser den Benutzer der Seiten beim wiederholten Aufrufen dieser Seiten wiederekennen kann <br>Innerhalb von Stud.IP werden Cookies benutzt, um den Namen und die Daten des angemeldeten Benutzers auf jeder Seite neu verf&uuml;gbar zu machen.<br>Ohne Cookies m&uuml;ssten Sie sich beim Betreten jeder Seite neu anmelden!")?>
			<br></font></blockquote>
			
			<b>&nbsp; <?=_("Sind Cookies gefahrlich?")?></b><br /><br />
			<blockquote>
			<font size =-1><?=_("Das Zulassen von Cookies stellt - leider - ein geringf&uuml;giges Sicherheitsrisiko dar. Jedoch sollten Sie Ihr Augenmerk darauf richten, dass in den meisten Browsern Techniken integriert sind, die ein deutlich gr&ouml;sseres Sicherheitsririko darstellen (etwa AktiveX-Elemente).<br>Ausserdem gibt es zwei verschiedene Arten von Cookies: Jene, die auf der Festplatte gespeichert werden und auf dem Rechner verbleiben, und solche, die nur solange aktiv sind, wie sie die entsprechenden Seiten benutzen.<br>Das Stud.IP-System nutzt nur die ungef&auml;hrlicheren Cookies, die sich nur f&uuml;r die Dauer der Sitzung im Speicher des Browser befinden und danach automatisch verschwinden.<br>Sie brauchen sich also keine Sorgen zu machen!")?>
			<br></font></blockquote>

			<b>&nbsp; <?=_("Hinweise f&uuml;r Benutzer des Netscape Navigator 4.x")?></b><br /><br />
			<blockquote>
			<font size =-1><?=_("Wenn Sie den Netscape Navigator 4.x benutzen, k&ouml;nnen Sie das Annehmen von Cookies auf folgende Weise einschalten:")?>
			<br />
			<ol type="1" start="1">
				<li><?=_("&Ouml;ffnen Sie das Menu \"Bearbeiten\" in der Kopfzeile des Browsers")?>
				<li><?=_("Gehen Sie auf \"Einstellungen\"")?>
				<li><?=_("Wählen sie jetzt auf der linken Seite der Einstellungsseite den Menüpunkt \"Erweitert\"")?>
				<li><?=_("Aktivieren sie jetzt auf der rechten Seite die Punkte:")?>
					<ul type="disc">
					<li><?=_("\"Benutze JavaScript\"")?>
					<li><?=_("\"Benutze Style Sheets\"")?>
					<li><?=_("\"Erlaube Cookies nur von dem Server, von dem die aktuelle Seite stammt\"")?>
					</ul>
			</ol>
			</font></blockquote>
			</td>
		</tr>
		<tr>
			<td class="blank">
			&nbsp;  
			</td>
		</tr>
		</table>
		</td></tr></table>
		<?
		die;
	}
	?>
	<table width=100% class=blank border=0 cellpadding=0 cellspacing=0><tr><td class=blank><blockquote>
	<br>
	<?=_("Bitte identifizieren Sie sich mit Benutzername und Passwort:")?><br />&nbsp; 
	
	<?
	if  (isset($this->auth["uname"]) && $this->error_msg):
	?>
	<!-- failed login code -->
	<table>
		<tr>
			<? parse_msg ("error§" . _("Bei der Anmeldung trat ein Fehler auf:") . " <br /><b>".$this->error_msg."</b>" . _("Versuchen Sie es noch einmal!") . "</b>", "§", "blank", 1, FALSE );?>
		</tr>
	</table>

	<?php endif;?>


	<FORM NAME="login" METHOD=POST ACTION="<?php print $this->url() ?>" onSubmit="return doChallengeResponse();">

	<!-- Set up the form with the challenge value and an empty reply value -->
	<input type="hidden" name="challenge" value="<?php print $challenge ?>">
	<input type="hidden" name="response"  value="">
	<input type="hidden" name="resolution"  value="">

	<table border=0 class="steel1" align="left" cellspacing=0 cellpadding=4>

		<tr valign=top align=left>
			<td class="steel1"><?=_("Benutzername:")?> </td>
			<td class="steel1"><input type="text" name="username" value="<?php print (isset($this->auth["uname"]) ? $this->auth["uname"] : "" ) ?>" size=20 maxlength=63></td>
		</tr>

		<tr valign=top align=left>
			<td class="steel1"><?=_("Passwort:")?> </td>
			<td class="steel1"><input type="password" name="password" size=20 maxlength=31></td> 
		</tr>

		<tr>
			<td class="steel1">&nbsp;</td>
			<td align=right class="steel1"><input type="image"  name="submitbtn" <?=makeButton("login","src")?> border="0" alt="Login" title="Login" value=" Login "></td>
		</tr>

	</table>
	</blockquote></td>
	<td align=right class=blank valign=top><img src="pictures/maus.jpg"></td></tr>
	<tr><td class=blank colspan=2 align=center><br><br><img src="./locale/<?=$_language_path ?>/LC_PICTURES/willkommen.gif" /></td></tr>
	<tr><td class=blank colspan=2>&nbsp;</td></tr>
	</table>
	</form>

</td></tr></table>

</body>
<script type="text/javascript" language="javascript">
<!--
  // Activate the appropriate input form field.
  if (document.login.username.value == '') {
    document.login.username.focus();
  } else {
    document.login.password.focus();
  }
// -->
</script>
</html>
